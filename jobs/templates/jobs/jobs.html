{% extends 'base.html' %} {% block content %}
<div class="container mt-4">
  <div class="row mb-4">
    <div class="col">
      <h1 class="display-4">ğŸ”¥ Job Board API</h1>
      <p class="lead">Production ready Django DRF</p>
    </div>
  </div>

  <div class="row mb-5">
    <div class="col">
      <a href="/admin/" class="btn btn-success btn-lg me-2">ğŸ› ï¸ Admin Panel</a>
      <a href="/api/docs/" class="btn btn-info btn-lg me-2">ğŸ“Š API Docs</a>
      <a href="#" class="btn btn-secondary btn-lg">â• Add Job (soon)</a>
      <br />

      <!-- Auth controls -->
      <div class="btn-group me-2 mt-3 mb-4" role="group">
        <button onclick="loadMyApplications()" class="btn btn-success">
          ğŸ“‹ My Applications
          <span id="authStatus" class="badge bg-secondary ms-1">?</span>
        </button>
        <button
          onclick="logout()"
          class="btn btn-outline-danger"
          id="logoutBtn"
          style="display: none"
        >
          ğŸšª Logout
        </button>
      </div>

      <!-- JWT Login button -->
      <button class="btn btn-outline-primary mt-3" onclick="showLogin()">
        ğŸ” API Login (admin/admin_admin123)
      </button>
    </div>
  </div>

  <!-- My Applications section -->
  <div id="myJobsSection" class="mt-4 mb-3" style="display: none">
    <h3>ğŸ“‹ My Applications</h3>
    <div id="myJobsContent">Loading...</div>
  </div>

  <h3 class="mt-4">ğŸ“‹ Available Jobs:</h3>

  <!-- Login Modal -->
  <div id="loginModal" class="modal" style="display: none">
    <div class="modal-content">
      <span onclick="hideLogin()" class="close">&times;</span>
      <h3>ğŸ” Login</h3>
      <input
        id="username"
        type="text"
        class="form-control mb-2"
        value="admin"
        placeholder="Username"
      />
      <input
        id="password"
        type="password"
        class="form-control mb-2"
        value="admin123"
        placeholder="Password"
      />
      <button onclick="apiLogin()" class="btn btn-primary w-100">Login</button>
      <div id="tokenResult" class="mt-3"></div>
    </div>
  </div>

  <!-- Jobs list -->
  {% if jobs %}
  <div class="row mt-4">
    {% for job in jobs %}
    <div class="col-md-6 col-lg-4 mb-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">{{ job.title }}</h5>
          <h6 class="card-subtitle text-muted">{{ job.company.name }}</h6>
          <p class="card-text">{{ job.description|truncatewords:15 }}</p>
          <a href="#" class="btn btn-outline-primary btn-sm">View</a>
          <button
            onclick="applyToJob({{ job.id }})"
            class="btn btn-primary btn-sm"
            id="apply-btn-{{ job.id }}"
          >
            Apply
          </button>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="alert alert-info mt-4">
    <h4>ğŸš€ No jobs yet!</h4>
    <p>Add your first job via <a href="/admin/">Admin Panel</a></p>
  </div>
  {% endif %}
</div>

<style>
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: #0008;
  }
  .modal-content {
    background: #fff;
    margin: 15% auto;
    padding: 20px;
    width: 400px;
    border-radius: 8px;
  }
  .close {
    float: right;
    font-size: 28px;
    cursor: pointer;
  }
</style>
{% endblock %}
